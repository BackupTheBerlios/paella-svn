<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title></title>
<link rel="stylesheet" href="default.css" type="text/css" />
</head>
<body>
<div class="document">


<!-- -*- mode: rst -*- -->
<div class="section" id="paella-quick-start-guide">
<h1><a class="toc-backref" href="#id2">Paella Quick Start Guide</a></h1>
<p>This guide is unfinished.  If you are reading this, do not expect the guide to be correct or
accurate.  This guide will not be ready to read, and the steps outlined should not be
attempted until this paragraph is removed.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#paella-quick-start-guide" id="id2">Paella Quick Start Guide</a><ul>
<li><a class="reference internal" href="#introduction" id="id3">Introduction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requirements" id="id4">Requirements</a><ul>
<li><a class="reference internal" href="#debian" id="id5">Debian</a></li>
<li><a class="reference internal" href="#hardware" id="id6">Hardware</a></li>
<li><a class="reference internal" href="#virtualbox-ose" id="id7">VirtualBox OSE</a></li>
<li><a class="reference internal" href="#debian-netinst-cd-image-lennybeta2" id="id8">Debian Netinst CD Image (LennyBeta2)</a></li>
<li><a class="reference internal" href="#remaster-the-netinst-iso" id="id9">Remaster the netinst iso</a></li>
</ul>
</li>
<li><a class="reference internal" href="#setup-the-paella-virtual-machine" id="id10">Setup the paella virtual machine</a></li>
<li><a class="reference internal" href="#boot-the-paella-virtual-machine" id="id11">Boot the paella virtual machine</a><ul>
<li><a class="reference internal" href="#install-the-paella-virtual-machine" id="id12">Install the paella virtual machine</a></li>
<li><a class="reference internal" href="#first-boot-on-the-paella-virtual-machine" id="id13">First boot on the paella virtual machine</a></li>
<li><a class="reference internal" href="#make-a-gpg-key" id="id14">Make a gpg key</a></li>
<li><a class="reference internal" href="#setup-initial-debian-mirror" id="id15">Setup initial debian mirror</a></li>
<li><a class="reference internal" href="#create-the-config-files-for-reprepro" id="id16">Create the config files for reprepro</a></li>
<li><a class="reference internal" href="#obtain-paella-from-subversion" id="id17">Obtain paella from subversion</a></li>
<li><a class="reference internal" href="#build-paella-packages-from-source-tree" id="id18">Build paella packages from source tree</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-paella-management-interface" id="id19">Using Paella Management Interface</a><ul>
<li><a class="reference internal" href="#install-the-admin-package" id="id20">Install the Admin Package</a></li>
<li><a class="reference internal" href="#setup-paellarc" id="id21">Setup ~/.paellarc</a></li>
<li><a class="reference internal" href="#start-paella-management" id="id22">Start paella-management</a></li>
<li><a class="reference internal" href="#import-the-database" id="id23">Import the database</a></li>
<li><a class="reference internal" href="#configure-quickstart-vbox-database" id="id24">Configure quickstart-vbox database</a></li>
<li><a class="reference internal" href="#configure-stage1-database" id="id25">Configure stage1 database</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install-the-uml-machines" id="id26">Install the UML Machines</a><ul>
<li><a class="reference internal" href="#install-uml-head" id="id27">Install uml_head</a></li>
<li><a class="reference internal" href="#install-umlbuilder" id="id28">Install umlbuilder</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-uml-machines" id="id29">Running the UML Machines</a><ul>
<li><a class="reference internal" href="#run-uml-head" id="id30">Run uml_head</a></li>
<li><a class="reference internal" href="#run-umlbuilder" id="id31">Run umlbuilder</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id3">Introduction</a></h2>
<!-- introductory comment -->
<p>Paella depends on a particular type of setup to operate.  This document details how to
bootstrap that setup, starting from the bare minimum requirements.  This guide is written
with the goal of minimizing the requirement for the root account to setup the system.  The
former method of working with paella, required (possibly) extensive configuring of a local
network.  In order to effectively use paella in a &quot;production&quot; environment, where you are
actually installing machines, still requires the same type of network configuration.  It is hoped
that the method outlined here can help prepare this by using paella to generate the
configuration that paella requires.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="requirements">
<h1><a class="toc-backref" href="#id4">Requirements</a></h1>
<div class="section" id="debian">
<h2><a class="toc-backref" href="#id5">Debian</a></h2>
<p>You should be running debian to follow this quickstart procedure.  It's technically not
required, but this document will assume that your running either lenny, sid, or etch
with VirtualBox running (from backports.org or similar).  This procedure has been tested
while running sid, although lenny should work just fine.  There also shouldn't really be
any problem with using etch, save for having to have VirtualBox installed.</p>
</div>
<div class="section" id="hardware">
<h2><a class="toc-backref" href="#id6">Hardware</a></h2>
<p>This quickstart routine was developed and tested using a laptop with 3GB of memory.
You could probably get by with less which I will try to estimate later.  Most of the memory
is required to run the virtual machines.  I estimate that only 2GB of ram will be required.
Please note that this is only the hardware requirements for following this quickstart
procedure, and doesn't reflect the actual requirements to run paella in a regular
environment with a network of machines.</p>
<p>You will need to run an operating system that can host VirtualBox OSE.</p>
</div>
<div class="section" id="virtualbox-ose">
<h2><a class="toc-backref" href="#id7">VirtualBox OSE</a></h2>
<p>This quickstart will use VirtualBox OSE to setup the machine that will act as the main
paella server, and also to test to make machines to test the installs.  The procedure outlined
below is assuming that you are using a GNU/Linux system as a host for VirtualBox OSE, but
there shouldn't be anything stopping somebody from using VirtualBox  on another host OS.</p>
</div>
<div class="section" id="debian-netinst-cd-image-lennybeta2">
<h2><a class="toc-backref" href="#id8">Debian Netinst CD Image (LennyBeta2)</a></h2>
<p>The upcoming lenny release is what is currently supported.  You should get the netinst iso,
which available on this <a class="reference external" href="http://www.debian.org/devel/debian-installer/">page</a>.  I used the <a class="reference external" href="http://cdimage.debian.org/cdimage/lenny_di_beta2/i386/iso-cd/debian-LennyBeta2-i386-netinst.iso">i386</a> image.  Hopefully any architecture should work,
but at the moment, only i386 is tested.  When I'm satisfied that the i386 is working properly, I'll
be testing the amd64 architecture.  Feedback on any other architectures would be appreciated.</p>
</div>
<div class="section" id="remaster-the-netinst-iso">
<h2><a class="toc-backref" href="#id9">Remaster the netinst iso</a></h2>
<p>This step is highly recommended.  This step is technically optional, but it may be handy,
especially if you have an application that can remaster an iso image.  This allows you to
preseed the debian installer and make an automated install.  Even though this step is
technically optional, it would be a very good idea to get the script below, and the files that
are obtained through subversion in the script to get an idea of how to proceed manually
without performing this step.</p>
<p>If you are running debian, remastering the iso is easy:</p>
<pre class="literal-block">
svn export svn://svn.berlios.de/paella/trunk/config/scripts/remaster-netinst-iso
</pre>
<p>if you already grabbed the netinst iso image, type:</p>
<pre class="literal-block">
./remaster-netinst-iso /path/to/debian-LennyBeta2-i386-netinst.iso
</pre>
<p>if you haven't gotten the netinst iso image yet, type:</p>
<pre class="literal-block">
./remaster-netinst-iso
</pre>
<p><strong>WARNING!!!</strong>  This script uses sudo to perform the loopback mounting of the iso
image.  Be sure to look over the script really good before you execute it.  You may want to
change the ARCH variable near the top of the file.  Be sure that you have rsync, sudo, and
subversion installed.</p>
<p>Either download the iso, and enter the filename as the first argument, or just run the script
without arguments.  The script will download the debian-LennyBeta2-i386-netinst.iso for you.</p>
<p>The script will give you a chance to review and edit the preseed files before you create the
remastered iso image.  When the script is finished, the iso image will be ./paella-netinst.iso .</p>
<p><strong>Note</strong>  The preseed configuration files, and the setup scripts assume that the locale
is set to en_US.UTF-8 .  If you are using another locale, you really need to modify both the
preseed.cfg file, and the setup-paella-server script.  The postgresql database server will not
run unless your locale is generated, and referenced in the postgresql.conf file.</p>
</div>
</div>
<div class="section" id="setup-the-paella-virtual-machine">
<h1><a class="toc-backref" href="#id10">Setup the paella virtual machine</a></h1>
<p>You need to get the virtualbox frontend up and running.</p>
<p>Make a new machine using the wizard provided by the virtualbox frontend.  Press next
and name the machine &quot;paella&quot;.  Select &quot;Debian&quot; for the OS type.  Press next.  Set the base
memory size to 512MB.  Press next.  Make a new disk image at the default 8GB size (I chose
dynamically expanding size).  Press finish.</p>
<p>Select paella from the list of machines on the frontend, and click the settings button.  In the
configuration dialog, select CD/DVD-ROM on the left hand side.  Click on the Mount CD/DVD
Drive button at the top.  Select the ISO Image File.  Press the folder on the right to bring up
the Virtual Disk Manager.  Here you want to add the netinst iso that you downloaded.  Close
the Virtual Disk Manager, and make sure that the iso is selected as the image file that will
be mounted.</p>
<p>Now, select the Network part of the list of the left hand side of the settings dialog.  By default,
the network adapter should be enabled, and set to NAT.  This is what we want.  We also want
to add another network interface to this machine, so select the Adapter 1 tab.  Click the
&quot;Enable Network Adapter&quot; button.  Make sure the &quot;Attached to&quot; selection is set to &quot;Internal
Network&quot;.  You will need to name the network in the field that says &quot;Network Name&quot;.  Any name
should do just fine.  I used &quot;lapnet&quot; (no quotes), since I'm on a laptop.  Remember this name,
since you'll need this for the other machine(s) that you will use paella to install to.</p>
</div>
<div class="section" id="boot-the-paella-virtual-machine">
<h1><a class="toc-backref" href="#id11">Boot the paella virtual machine</a></h1>
<div class="section" id="install-the-paella-virtual-machine">
<h2><a class="toc-backref" href="#id12">Install the paella virtual machine</a></h2>
<p>Now you should be ready to boot the virtual machine, and install debian lenny.</p>
<p>Boot the machine by pressing Start (the green arrow) on the virtualbox frontend (make sure
the paella virtual machine is the one that's selected).  When the boot screen appears, select
one of the first two menu options.  Don't bother selecting the second option unless you have
a local debian mirror, and you have modified the preseed files.</p>
<p>If you remastered the netinst iso, the install will proceed automatically.  The setup scripts
will be copied to /usr/local/bin by the debian installer.</p>
<p>If you didn't remaster the netinst file, you can find the preseed files, and the setup scripts
in the <a class="reference external" href="http://paella.berlios.de/netinst/">netinst</a> directory on the paella website.  You can just install debian in the normal
manner.  You'll need to select the standard, desktop, and database-server tasks.  Look at
the preseed file to see how the default setup is configured.  The hostname, main user, and
the main user's password are all set to &quot;paella&quot; to make it easy to remember.  The paella
user should be added to the src, staff, adm, and sudo groups, but this probably isn't
an absolute necessity.  Set the dhcp3-server to listen to eth1 on the debconf question.</p>
<p>The rest of the instructions will assume that you installed from a remastered iso.</p>
</div>
<div class="section" id="first-boot-on-the-paella-virtual-machine">
<h2><a class="toc-backref" href="#id13">First boot on the paella virtual machine</a></h2>
<p>After the debian installer is finished, the virtual machine should reboot .  You should take
this time to disassociate the iso image from the machine in the VirtualBox frontend, else
the iso will boot everytime you boot the virtual machine.</p>
<p>When the sytem boots up for the first time, login as paella (password paella).  You may
want to load this webpage in a web browser in the virtual machine, so you can more easily
cut and paste from this page.  We need to start configuring the server. Start a terminal
and type:</p>
<pre class="literal-block">
sudo setup-paella-server
</pre>
<p>This should set up everything that couldn't be done on the debian installer.  This script
will setup the cofiguration of the database, firewall, dhcp server, and the network interface
for the internal network.</p>
<p>While I've tried to make things work by restarting services, things don't always work right.
You may need to reboot the virtual machine after this script, if you notice errors in restarting
the servers at the end of the execution of the script.  If you do encounter the errors, and don't
feel like rebooting, restart these services:</p>
<pre class="literal-block">
sudo /etc/init.d/networking restart
sudo /etc/init.d/postgresql-8.3 restart
sudo /etc/init.d/shorewall restart
sudo /etc/init.d/apache2 restart
</pre>
<p>In the xorg.conf file, the screen resolution is set to 1024x768.  This is because the default
screen size for VESA is 1280x1024, which is too big for my laptop.  Feel free to edit this file,
or restore the original at /etc/X11/xorg.conf.orig .  You may also want to use the virtualbox
guest drivers, but the input drivers (mouse and keyboard) stopped working when I tried
them.  The vesa driver is known to work, even though it's probably not nearly as efficient.</p>
</div>
<div class="section" id="make-a-gpg-key">
<h2><a class="toc-backref" href="#id14">Make a gpg key</a></h2>
<p>You'll need a gpg key to sign the Release files of the local debian repository.  This is important,
since debian has spent a great deal of time making it possible to verify the authenticity of the
packages being installed on your system.  Full instructions on how to generate a key and use it
properly are beyond the scope of this docuement.  You can find more detailed
at <a class="reference external" href="http://www.gnupg.org/">http://www.gnupg.org/</a> .</p>
<p>If you just want to get up and running, you can follow these quick and <strong>potentially insecure</strong> instructions.
Type:</p>
<pre class="literal-block">
echo $USER&#64;`cat /etc/mailname`
</pre>
<p>This will be the default email address used to search for the key that signs the packages
you build.  We will also use this key to sign the Release file in the locally generated mirror.</p>
<p>Now type:</p>
<pre class="literal-block">
getent passwd | grep $USER | cut -f5 -d: | cut -f1 -d,
</pre>
<p>This will be the &quot;Real Name&quot; that you will use for the key.  Either remember the email and &quot;Real
Name&quot;, or use another terminal to generate the key.</p>
<p>Now type:</p>
<pre class="literal-block">
gpg --gen-key
</pre>
<p>Answer the questions in the dialog.  It should be ok to answer the defaults, until you get to
the question asking &quot;Is this correct?&quot;.  After this, you'll need to enter the &quot;Real Name&quot; and
email address that you obtained from the steps above.  You can enter an empty passphrase,
but remember that you can't use this key for anything more serious than working with paella
in a testing environment.  If you do want a passphrase, you'll also need to know how to use
gpg-agent, which is also beyond the scope of this document.</p>
<p>You'll need to know the key ID of the gpg key for the steps below. Here, I'm assuming
that the &quot;Real Name&quot; you entered above is &quot;Paella User&quot;.  To obtain it, type:</p>
<pre class="literal-block">
gpg --fingerprint &quot;Paella User&quot; | grep ^pub | cut -f2 -d/ | cut -f1 -d' '
</pre>
<p>You should get an eight digit hexadecimal number, which you'll need to remember.  From
here on, I'll just refer to it as your gpg key ID.  If you need more random bytes, type this
in another window:</p>
<pre class="literal-block">
find /usr/share | xargs sha1sum
</pre>
<p>In an earlier version of this document, I referred to the key ID as the fingerprint, which is
inaccurate.  The code for paella may still refer to the key ID as a fingerprint, and might not
be corrected by the time you read this.  Please keep this in mind as you use paella.  I hope to
have the code corrected after I'm sure that this quickstart routine is fully functional.</p>
</div>
<div class="section" id="setup-initial-debian-mirror">
<h2><a class="toc-backref" href="#id15">Setup initial debian mirror</a></h2>
<p>If you already have a local debian mirror, you can probably skip this step.</p>
<p>type:</p>
<pre class="literal-block">
sudo apt-move update
sudo rm /freespace/debian/.apt-move -fr
sudo rm /freespace/debian/dists -fr
sudo chown -R paella:staff /freespace/debian/*
</pre>
<p>This will move all the packages installed on the virtual machine to /freespace/debian .  This will
be the last that apt-move will be used, since we just needed it to move the installed packages
and setup the initial repository structure.</p>
<p>Now type:</p>
<pre class="literal-block">
mkdir /freespace/debian/conf
dpkg --get-selections &gt; /freespace/debian/conf/local-packages
</pre>
<p>This will be the configuration directory for reprepro.  We will be using reprepro to generate
and maintain the local debian mirror for here on.</p>
</div>
<div class="section" id="create-the-config-files-for-reprepro">
<h2><a class="toc-backref" href="#id16">Create the config files for reprepro</a></h2>
<p>In the instructions below, you don't have to create these files.  You can copy them from the
remastered netinst cdrom that you made. You may need to attach the image in virtualbox using
the devices menu.  You can check that the cd image is attached by pulling up the Session
Information Dialog from the Machine menu on the far left.  Once you're sure that the image is
attached in virtualbox, you need to mount it. To do this, type:</p>
<pre class="literal-block">
mount /media/cdrom
</pre>
<p>Then copy the files for reprepro:</p>
<pre class="literal-block">
cp /media/cdrom/paella/reprepro/* /freespace/debian/conf
chmod +w /freespace/debian/conf/*
</pre>
<p>Now type:</p>
<pre class="literal-block">
editor /freespace/debian/conf/distributions
</pre>
<p>In the editor you want to type something similar to this:</p>
<pre class="literal-block">
Origin: Debian
Label: Debian
Suite: testing
Version: 4.0
Codename: lenny
Architectures: i386
Components: main contrib non-free
Description: Debian x.y Testing - Not Yet Released
Log: logfile
Update: lenny security-testing
SignWith: &lt;your gpg key ID&gt;

Origin: Paella
Label: Paella
Suite: paella
Version: 4.0
Codename: paella
Architectures: i386 source
Components: main contrib non-free
Description: Paella local repository
Log: logfile
SignWith: &lt;your gpg key ID&gt;
</pre>
<p>Be sure to replace &lt;your gpg key ID&gt; with the actual key ID that you obtained above.</p>
<p>Now we want to use the editor again:</p>
<pre class="literal-block">
editor /freespace/debian/conf/updates
</pre>
<p>In the editor you want to type  something similar to this:</p>
<pre class="literal-block">
Name: lenny
Method: http://ftp.us.debian.org/debian
Fallback: http://ftp.de.debian.org/debian
VerifyRelease: 6070D3A1
Architectures: i386
Components: main contrib non-free
UDebComponents: none
FilterList: deinstall startup-packages extra-packages local-packages

Name: security-testing
Method: http://security.debian.org/debian-security
VerifyRelease: 6070D3A1
Suite: testing/updates
Architectures: i386
Components: main contrib non-free
UDebComponents: none
FilterList: deinstall startup-packages extra-packages local-packages
</pre>
<p>In order to verify the release files, you'll need to import the debian archive signing key:</p>
<pre class="literal-block">
gpg --recv-keys 6070D3A1
</pre>
<p>Now would also be a good time to export the public key you made above:</p>
<pre class="literal-block">
gpg --export -a &gt; /freespace/debian/paella.gpg
</pre>
<p>Let apt on paella know about it too:</p>
<pre class="literal-block">
sudo apt-key add /freespace/debian/paella.gpg
</pre>
<p>To make sure apt got the key:</p>
<pre class="literal-block">
sudo apt-key list
</pre>
<p>Make sure the key is on the list</p>
<p>Now we're ready to use reprepro to manage the repository:</p>
<pre class="literal-block">
reprepro -b /freespace/debian/  -VV update
</pre>
<p>The -VV options sets the verbosity of reprepro to 10, which will help determine if anything
goes wrong, and where it does go wrong.</p>
<p>Take a break.  Grab some coffee.  This will take a bit, depending on your internet
connection.  I've taken care to only include the packages that needed, plus a few
extra packages that I use as tools to help me test this quickstart routine.  As of the time
this was written, the pool directory was 421MB in size.</p>
<p>After the update is done, you may need to export the packages lists:</p>
<pre class="literal-block">
reprepro -b /freespace/debian/  -VV export
</pre>
<p>Since reprepro doesn't make verbatim mirrors, when you update from security.debian.org,
the updated packages are added to the main package list for the suite, instead of
&lt;suite&gt;/updates .  This is generally a good thing, since when you use a local mirror generated
by reprepro, you only need one apt source line.  Paella, however was developed before
reprepro existed, and used to mirror the complete debian archive.  Until paella is fixed to work
better with this, the workaround is to trick paella into thinking it's looking at &lt;suite&gt;/updates .
To do this, type:</p>
<pre class="literal-block">
pushd /freespace/debian/dists/lenny
ln -s . updates
popd
</pre>
<p>Hopefully things went well.  You should wind up with just enough of a partial mirror to complete
the instructions and get a feel for paella.</p>
<p>Now it's time to add the new mirror to the sources list:</p>
<pre class="literal-block">
sudo editor /etc/apt/sources.list
</pre>
<p>Make sure these lines are at the top:</p>
<pre class="literal-block">
deb http://paella/debian lenny main contrib non-free
deb http://paella/debian paella main contrib non-free
deb-src http://paella/debian paella main contrib non-free
</pre>
<p>Now update apt with the new sources:</p>
<pre class="literal-block">
sudo apt-get update
</pre>
</div>
<div class="section" id="obtain-paella-from-subversion">
<h2><a class="toc-backref" href="#id17">Obtain paella from subversion</a></h2>
<p>Now you're ready to get the source code from subversion.  To do this, type</p>
<pre class="literal-block">
cd
paella-user-quick-setup
</pre>
<p>This will setup the directories, and download the source code from the berlios subversion
repository.  If you plan on working on the code in the working copy, you'll need to either source
the paella_environment file, add the lines of that file to your .bashrc, or source the file from
your .bashrc if you plan on working on the code.  Since you're using a virtual machine, it
would probably be best to add it to your .bashrc</p>
<pre class="literal-block">
cat paella_environment &gt;&gt; .bashrc
</pre>
<p>This is optional, as it's only needed to work with the code, and possibly fix bugs that you
encounter.</p>
<p><strong>Important:</strong>  You need to cut and paste the apt-get command from the output
of the script, to build all of the paella and python-useless-* packages.</p>
</div>
<div class="section" id="build-paella-packages-from-source-tree">
<h2><a class="toc-backref" href="#id18">Build paella packages from source tree</a></h2>
<p>Now it's time to build the useless and paella packages.  First we're going to start with the
useless package.  Pay attention to the lines below, as you won't be able to just cut-n-paste
these lines:</p>
<pre class="literal-block">
cd ~/workspace/useless
dch -n  # This will create an NMU (Non-maintainer upload)
# type something like &quot;testing paella&quot; to the right of the asterisk
# save the file in the text editor
debuild
reprepro -b /freespace/debian --ignore=wrongdistribution include paella ../useless_&lt;version&gt;_i386.changes
</pre>
<p>Repeat this process for paella:</p>
<pre class="literal-block">
cd ~/workspace/paella
dch -n  # This will create an NMU (Non-maintainer upload)
# type something like &quot;testing paella&quot; to the right of the asterisk
# save the file in the text editor
debuild
reprepro -b /freespace/debian --ignore=wrongdistribution include paella ../paella_&lt;version&gt;_i386.changes
</pre>
<p>Normally, you'd export the working copy before building the packages, but we'll just be sloppy
here, because we're almost ready to install the packages that were just built.  There's no
need to build them correctly until you're sure that paella is the right type of program for your
needs.</p>
<p>Let's test our new mirror:</p>
<pre class="literal-block">
sudo apt-get update
</pre>
<p>If you are getting hash mismatches from apt, try this:</p>
<pre class="literal-block">
rm /freespace/debian/dists/* -fr
reprepro -b /freespace/debian/  -VV export
pushd /freespace/debian/dists/lenny
ln -s . updates
popd
</pre>
<p>I got these mismatches a few times, and don't know what caused the errors.  When I get
the time to investigate the problem further, I'll find a better solution, but this solution should
work just fine for our purposes here.</p>
</div>
</div>
<div class="section" id="using-paella-management-interface">
<h1><a class="toc-backref" href="#id19">Using Paella Management Interface</a></h1>
<div class="section" id="install-the-admin-package">
<h2><a class="toc-backref" href="#id20">Install the Admin Package</a></h2>
<p>Now we're almost ready to use the management interface.  To install it, type:</p>
<pre class="literal-block">
sudo apt-get install paella-admin
</pre>
<p>The executable is called <strong>paella-management</strong>.  You can either type it into a
terminal, or find it in the debian menu (but not in the kde menu, yet).  Don't run it yet, you
should set up the configuration file first.</p>
</div>
<div class="section" id="setup-paellarc">
<h2><a class="toc-backref" href="#id21">Setup ~/.paellarc</a></h2>
<p>The master config file will be found at /etc/paellarc .  The master config file is the one that
the installer will use.  You can copy this file to ~/.paellarc and edit it.  The paella-management
program will read the master config file, then the local one at ~/.paellarc .  The local file will
override options in the master file.  If you are not familiar with the file format, you can read
about it <a class="reference external" href="http://docs.python.org/lib/module-ConfigParser.html">here</a> .  Options that are prefixed by an underscore are not referenced in the code.
You can make your own underscored options, if you wish, to make it easier to edit.</p>
<dl class="docutils">
<dt>Type::</dt>
<dd>cd
cp /etc/paellarc .paellarc</dd>
</dl>
<p>In the database section, the dbhost option should be the ip address of the eth1 interface,
which should be 10.0.1.1 .  You will also need to change the dbusername option to the database
admin user (dbadmin).  The dbusername in the master config file should  always be &quot;paella&quot;.</p>
<p>The management_gui section has options for the paella-management application.  The options
that you may want to change here are &quot;text_editor&quot;, and &quot;x_differ&quot;.  Both of these commands
should display an X window.  For the x_differ, I highly recommend xxdiff.  The x_differ command
line conform to this:</p>
<pre class="literal-block">
x_differ LeftFile RightFile
</pre>
<p>If your differ needs options on the command line, please write a wrapper for it, and use that.</p>
<p>You should not need to change any other options.</p>
</div>
<div class="section" id="start-paella-management">
<h2><a class="toc-backref" href="#id22">Start paella-management</a></h2>
<p>Run the paella-management script to start the management interface.  The first thing that you
will want to do is to connect to the database.  There is a connect button on the toolbar for you
to press.  The connection dialog entries are taken from your ~/.paellarc file.  The settings
for postgresql in this quickstart don't require a password for dbadmin, but you'll want to use
one if you use paella in a production environment.</p>
<p>Once you connect to the database, you should get a dialog asking to create the primary
tables.  You should click yes here to setup an empty database structure.  If you don't do
this, the database import procedure will create these tables for you, but you won't be able to
use the paella-management interface until you do this.</p>
<p><strong>The information below is outdated.  To be continued ....</strong></p>
</div>
<div class="section" id="import-the-database">
<h2><a class="toc-backref" href="#id23">Import the database</a></h2>
<p>Now we are going to import the startup database.  You may need an internet connection to
import the database.  The importer downloads the Packages files from the debian mirror in
the database.xml file, and inserts them into the database.  Go to the menubar, and in the
database menu, select &quot;import database&quot;.  A directory selection dialog will appear.  The
database directory will be at:</p>
<pre class="literal-block">
~/workspace/paella/config/share/databases/quickstart-vbox/
</pre>
<p>Note that the default debian mirror is  <a class="reference external" href="http://ftp.us.debian.org/debian">http://ftp.us.debian.org/debian</a> .  If you need to
change this, edit the database.xml file in the quickstart-vbox  directory, and alter the uri
attribute to the aptsource xml element at the top of the file.  You can change this to a local
mirror if you already have one.  I recommend against using the local mirror that you just
created in this quickstart routine, as you would likely want to make new traits with packages
that aren't available in that mirror.  Paella has only been tested with http apt sources, it's
behaviour on other methods is unknown.</p>
<p>If everything is working, you should be seeing an ugly little progress dialog displaying
something resembling what it should be doing.  I need to fix this dialog to make it more
accurate, but at least you'll see it working while it inserts the information into the
database.  The packages will probably take a little while to insert.  The apt_source_packages
table can take a lot of space that could be better saved.  In the future, it will probably default
to only holding package names rather than the other attributes in the Packages file.  The
reason they are there is to help keep the automated installations from bombing due to
unavailable or misspelled packages.  It would also be nice to have a little package browser
to help when creating traits, but that's in the future.</p>
</div>
<div class="section" id="configure-quickstart-vbox-database">
<h2><a class="toc-backref" href="#id24">Configure quickstart-vbox database</a></h2>
</div>
<div class="section" id="configure-stage1-database">
<h2><a class="toc-backref" href="#id25">Configure stage1 database</a></h2>
<p>There should be very little effort needed to configure the stage1 database.
Check default environment.
Check tap_network family.
Check uml_startup family.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="install-the-uml-machines">
<h1><a class="toc-backref" href="#id26">Install the UML Machines</a></h1>
<p>Now we should be ready to install the uml machines.  The uml installer is currently limited to
installing one machine at a time.  This is due to the default configuration for this quickstart
guide using a static ip.  This can be easily changed later if you wish to use the uml installer
for testing purposes.</p>
<div class="section" id="install-uml-head">
<h2><a class="toc-backref" href="#id27">Install uml_head</a></h2>
<p>type:</p>
<pre class="literal-block">
paella-umlrunner install uml_head
</pre>
</div>
<div class="section" id="install-umlbuilder">
<h2><a class="toc-backref" href="#id28">Install umlbuilder</a></h2>
<p>type:</p>
<pre class="literal-block">
paella-umlrunner install umlbuilder
</pre>
</div>
</div>
<div class="section" id="running-the-uml-machines">
<h1><a class="toc-backref" href="#id29">Running the UML Machines</a></h1>
<p>Now we should be ready to start running the uml machines.</p>
<div class="section" id="run-uml-head">
<h2><a class="toc-backref" href="#id30">Run uml_head</a></h2>
<p>Make sure your umask is set to 022.</p>
<p>type:</p>
<pre class="literal-block">
paella-umlrunner run uml_head
</pre>
<p>Login as root.  There should be no password required.
type:</p>
<pre class="literal-block">
./setup_debrepos
</pre>
<p>This will run a script that will setup a partial debian mirror.  This is to keep from
having to use a full debian mirror, that used to be required previously to use paella.  This
partial mirror should be under 400MB in size.</p>
</div>
<div class="section" id="run-umlbuilder">
<h2><a class="toc-backref" href="#id31">Run umlbuilder</a></h2>
<p>type:</p>
<pre class="literal-block">
paella-umlrunner run umlbuilder
</pre>
<p>Login as root.  There should be no password required.
type:</p>
<pre class="literal-block">
./init_pbuilder
</pre>
<p>This will run a script that will prepare pbuilder to build the paella and useless packages.
Basically it either generates or restores the base.tgz for pbuilder.  The base.tgz is copied to
the hostfs mount, in case it is needed in the future.  Once the script finishes, the next step
is to get the useless and paella packages built.  There is a script that does this too.
type:</p>
<pre class="literal-block">
./build_paella_from_subversion
</pre>
<p>This script will checkout the sources from subversion.  It then exports the working copies and
uses pbuilder to build the exports.  Once the packages are built, they are uploaded to
the uml_head machine, and placed in the debian mirror.</p>
<p>This <a class="reference external" href="http://developer.berlios.de/projects/paella">project</a> is hosted by <a class="reference external" href="http://developer.berlios.de"><img alt="berlios" src="http://developer.berlios.de/bslogo.php?group_id=0&amp;type=1" /></a>.</p>
<p><a class="reference external" href="/">home</a></p>
</div>
</div>
</div>
</body>
</html>
