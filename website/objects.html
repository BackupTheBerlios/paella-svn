<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title></title>
<link rel="stylesheet" href="default.css" type="text/css" />
</head>
<body>
<div class="document">


<!-- -*- mode: rst -*- -->
<div class="section" id="objects-and-definitions">
<h1>Objects and Definitions</h1>
<div class="section" id="apt-source">
<h2>Apt Source</h2>
<p>An apt source is similar to a line in an /etc/apt/sources.list file.</p>
</div>
<div class="section" id="suite">
<h2>Suite</h2>
<p>A suite is a similiar to debian suites like woody or sarge.  A suite
can be used to make different versions of configurations, or different
styles of design and configurations.  Traits are held in suites.</p>
<p>Basically a suite is an ordered list of apt sources, and a set of traits.</p>
</div>
<div class="section" id="trait">
<h2>Trait</h2>
<p>A trait is the atomic unit that signifies a feature.
A trait belongs to a suite.  The table in the database that holds the list of traits
is called $(suite)_traits.  A trait can have packages, parents, templates, scripts
and a set of variables.</p>
<ul>
<li><p class="first"><strong>parents</strong></p>
<ul class="simple">
<li>no trait can be processed during the installation before all
of its parents are processed.</li>
<li>parents are not required, but most traits should depend on a default
trait.</li>
<li>no trait can be processed during the installation before all of its
parents are processed.</li>
</ul>
</li>
<li><p class="first"><strong>packages</strong></p>
<ul class="simple">
<li>this is a list of packages to install or remove
- although other options are available, only install and remove are supported now</li>
<li>packages are not required</li>
</ul>
</li>
<li><p class="first"><strong>templates</strong></p>
<ul class="simple">
<li>templates can have simple tags for variable substitution</li>
<li>templates store user/group and chmod permissions</li>
<li>a template must currently be attached to a package<ul>
<li>this feature should be removed, because traits that only need
traits get vestigial packages assigned to them like base-files,
initscripts, or bash</li>
</ul>
</li>
<li>currently the var/cache/debconf/config.dat template is reserved
for debconf</li>
</ul>
</li>
<li><p class="first"><strong>environment</strong></p>
<ul>
<li><p class="first">a collection of name, value pairs for use in the templates and scripts</p>
</li>
<li><p class="first">a trait's environment contains its parents' environment</p>
</li>
<li><dl class="first docutils">
<dt>a big python dictionary is made of the environment where the keys</dt>
<dd><p class="first last">are formed as &quot;trait_name&quot; where trait is the trait and name is the
name of the variable.</p>
</dd>
</dl>
</li>
</ul>
</li>
<li><p class="first"><strong>scripts</strong></p>
<ul class="simple">
<li>a trait is not required to have a script</li>
<li>only three types of scripts are currently supported, pre, post, and chroot<ul>
<li>chroot is a special script that is run in a chrooted environment in the target area.
This script should be aware of what's on the target system and only depend on
those things. The script shouldn't connect to paella or depend on other installation
tools not present in the target system.</li>
<li>pre is executed before anything else is processed in the trait.<ul>
<li>The pre script is executed with an os.system.</li>
</ul>
</li>
<li>post is the very last action to perform in the trait<ul>
<li>post should be able to talk to database and environment</li>
</ul>
</li>
</ul>
</li>
<li>other scripts<ul>
<li>you can define a script for any
step in the trait install process.</li>
<li>if you make a script named install, remove, config,
or reconfig, that step in the trait process is ignored,
and the script run instead.  The script doesn't have
to do anything, so it's a good way to skip a step in the
trait installation</li>
<li>in order for a script to be executed its name must match
a step in the trait processes.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="family">
<h2>Family</h2>
<ul class="simple">
<li>A family is a collection of variables from different traits<ul>
<li>a family can have parents</li>
<li>a family is not tied to a suite</li>
<li>a variable in a family doesn't have to exist in a trait,
but it has to be tied to a trait.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="profile">
<h2>Profile</h2>
<ul>
<li><p class="first">A profile is a collection of traits, and an environment</p>
<ul>
<li><p class="first">Traits - the traits listed in the profile are ordered</p>
</li>
<li><p class="first">Families - an unordered list of families</p>
</li>
<li><dl class="first docutils">
<dt>Environment</dt>
<dd><ul class="first last simple">
<li>the profile environment overrides the trait environments
and the family environment</li>
</ul>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="machine-database">
<h1>Machine Database</h1>
<p>This section describes the machine database part of paella.  Profile, traits, and families
should not be machine specific.  The Machine database trying to be design to hold
information about physical systems to install logical systems from.</p>
<div class="section" id="machine-type">
<h2>Machine Type</h2>
<p>A machine type is going to be the main identifier of a particular type of machine.
This currently includes disks and kernel modules.  The disks of a machine type are a
list of tuples in the database (machine_type, diskname, device) .  The current policy is
to treat all devices of a certain  diskname as a raid1 array if there is more than one
device.  Machine Types will have parents soon.</p>
</div>
<div class="section" id="machine-type-scripts">
<h2>Machine Type Scripts</h2>
<p>Machine type scripts are steps in the install process for machines.  These steps
will be treated similiar to the trait scripts. The default steps/scripts are:</p>
<ul class="simple">
<li>pre<ul>
<li>this step normally does nothing.</li>
</ul>
</li>
<li>setup_disks<ul>
<li>this step is responsible for partitioning the disks and
for creating the filesystems</li>
</ul>
</li>
<li>mount_target<ul>
<li>this step is responsible for mounting the filesystems
created in the previous step to the target directory</li>
<li>the script will need to make the subdirectories in target
for filesystems under the target root, and mount the
appropriate ones.</li>
</ul>
</li>
<li>bootstrap<ul>
<li>this step is responsible for bootstrapping the base
system into the target directory.</li>
</ul>
</li>
<li>apt_sources_installer<ul>
<li>this step should create a sources.list file that is appropriate
for the installer environment.  It should place the file in
$target/etc/apt/sources.list</li>
</ul>
</li>
<li>ready_base<ul>
<li>this is a legacy step in the installer that would setup a root
password, a simple /etc/network/interfaces file, and a fstab.</li>
</ul>
</li>
<li>pre_install<ul>
<li>this step normally does nothing.</li>
</ul>
</li>
<li>install<ul>
<li>this step performs the install process</li>
</ul>
</li>
<li>post_install<ul>
<li>this step normally does nothing.</li>
</ul>
</li>
<li>install_modules<ul>
<li>this step should create a $target/etc/modules file appropriate for
the machine type.</li>
</ul>
</li>
<li>install_kernel<ul>
<li>this step is reponsible for installing a kernel in the target and
preparing the bootloader for booting.</li>
<li>the machine should be ready to reboot after this step</li>
</ul>
</li>
<li>apt_sources_final<ul>
<li>this step is reponsible for making a sources.list that will
be used when the machine is on the target site.  This step can be
skipped for on-site installations.</li>
</ul>
</li>
<li>install_fstab<ul>
<li>this step is reponsible for installing the fstab on the target system.</li>
</ul>
</li>
<li>post<ul>
<li>this step normally does nothing.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="machine">
<h2>Machine</h2>
<p>a machine contains</p>
<ul class="simple">
<li>a <strong>name</strong></li>
<li>a <strong>machine_type</strong><ul>
<li>this is one of the machine types that are already defined</li>
</ul>
</li>
<li>a <strong>kernel</strong><ul>
<li>a kernel is simply the name of a kernel image package</li>
<li>the package must be install-able by apt, in a chroot environment, on the target system.</li>
</ul>
</li>
<li>a <strong>filesystem</strong><ul>
<li>a <a class="reference internal" href="#filesystem">filesystem</a> is a named ordered map of <a class="reference external" href="#mount">mounts</a> to partition numbers</li>
</ul>
</li>
<li>a <strong>profile</strong></li>
</ul>
</div>
<div class="section" id="mount">
<h2>Mount</h2>
<p>a <a class="reference internal" href="#mount">mount</a> is named</p>
<p>a mount describes filesystem type, mount option, dump, pass and the mount point</p>
</div>
<div class="section" id="filesystem">
<h2>Filesystem</h2>
<p>this is done on filesystem_mounts</p>
<p>the target fstab will be completely formed from the filesystem information</p>
<hr class="docutils" />
<p>This <a class="reference external" href="http://developer.berlios.de/projects/paella">project</a> is hosted by <a class="reference external" href="http://developer.berlios.de"><img alt="berlios" src="http://developer.berlios.de/bslogo.php?group_id=0&amp;type=1" /></a>.</p>
<p><a class="reference external" href="/">home</a></p>
</div>
</div>
</div>
</body>
</html>
